---
title: ""
author: ""
output:
  pdf_document:
    citation_package: natbib
    fig_caption: yes
bibliography: ["book.bib",  "packages.bib"]
biblio-style: "apalike"
csl: apa.csl
header-includes:
- \usepackage{float}
- \usepackage{booktabs}
- \usepackage{pdflscape}
- \usepackage{setspace}\onehalfspacing
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
- \usepackage{caption}
- \captionsetup[table]{font=small}
- \captionsetup[figure]{font=small}
- \captionsetup[table]{labelformat=empty}
- \captionsetup[figure]{labelformat=empty}
- \usepackage{dcolumn} #for sidewaystable
---

```{r, include=FALSE}
options(tinytex.verbose = TRUE)
options(knitr.table.format = "latex")
```

```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown', 'lme4', 'AICcmodavg', 'car', 'piecewiseSEM', 'MuMIn', 'stringr', 'dplyr', 'ggplot2', 'devtools', 'rgdal', 'broom', 'sf', 'ggthemes', 'rgeos', 'RCurl', 'readxl', 'pointRes', 'dplR', 'data.table', 'tools', 'reshape2', 'kableExtra', 'raster', 'elevatr', 'dynatopmodel', 'grid', 'gridExtra', 'ggstance', 'Hmisc', 'magrittr', 'ggpubr'
), 'packages.bib')
```


```{r Table 1, eval = TRUE, echo=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)
hypothesis_table <- read.csv("tables_figures/publication/table1_hypothesis_table.csv", stringsAsFactors = FALSE, check.names = FALSE)
kable(hypothesis_table, format = "latex", booktabs = TRUE, caption = "Table 1. Summary of hypotheses, corresponding specific predictions, and results. We count predictions as fully supported ('yes') when the response is signficant in single-variable tests (Table 4) and included in all top full models and as partially supported ('(yes)') or rejected ('(no)') when the direction of response consistently matched the prediction but the effect was not significant in all models.") %>%
  kable_styling(latex_options = c("scale_down", "hold_position"), font_size = 8.5, protect_latex = TRUE) %>%
  pack_rows("Tree size and microenvironment", 1, 5, latex_gap_space = "1em", colnum = 1, hline_before = FALSE) %>%
  pack_rows("Larger, taller trees have lower Rt.", 1, 2, latex_gap_space = "1em", colnum = 1, hline_before = FALSE, bold = FALSE, italic = TRUE) %>%
  pack_rows("Trees with more exposed crowns have lower Rt.", 3, 4, latex_gap_space = "1em", colnum = 1, hline_before = FALSE, bold = FALSE, italic = TRUE) %>%
  pack_rows("Small trees (lower root volume) in drier microhabitats have lower Rt.", 5, 5, latex_gap_space = "1em", colnum = 1, hline_before = FALSE, bold = FALSE, italic = TRUE) %>%
  pack_rows("Species traits", 6, 10, latex_gap_space = "1em", colnum = 1, hline_before = FALSE) %>%
  pack_rows("Species' traits--particularly leaf hydraulic traits--predict Rt.", 6, 10, latex_gap_space = "1em", colnum = 1, hline_before = FALSE, bold = FALSE, italic = TRUE) %>%
  add_header_above(c(" ", "Prediction supported?" = 4, " ")) %>%
  column_spec(1, width = "12cm") %>%
  column_spec(2:5, width = "1.2cm") %>%
  column_spec(6, width = "2.4cm") %>%
  kableExtra::landscape()
```

\clearpage

```{r Table 2, eval = TRUE, echo=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)
table2 <- read.csv("tables_figures/publication/table2_variables_table.csv", stringsAsFactors = FALSE, check.names = FALSE)
kable(table2, format = "latex", booktabs = TRUE, caption = "Table 2. Summary of variables.", 
        escape=FALSE) %>%
  kable_styling(latex_options = c("scale_down", "hold_position"), font_size = 10, protect_latex = TRUE) %>%
  column_spec(4, width = "7cm") %>%
  pack_rows("Dependent variable", 1, 1, latex_gap_space = "1em", colnum = 1, hline_before = FALSE) %>%
  pack_rows("Independent variables", 2, 18, latex_gap_space = ".4em", colnum = 1, hline_before = FALSE) %>%
  pack_rows("tree size", 5, 6, latex_gap_space = ".4em", colnum = 1, hline_before = FALSE, bold = FALSE, italic = TRUE) %>%
  pack_rows("microhabitat", 7, 11, latex_gap_space = ".4em", colnum = 1, hline_before = FALSE, bold = FALSE, italic = TRUE) %>%
  pack_rows("species' traits", 12, 18, latex_gap_space = ".4em", colnum = 1, hline_before = FALSE, bold = FALSE, italic = TRUE) %>%
  kable_styling()
```
\clearpage

```{r, Table 3, eval=TRUE, echo=FALSE, message=FALSE}
library(knitr)
library(kableExtra)
table3 <- read.csv("tables_figures/publication/table3_species_table.csv", stringsAsFactors = FALSE, check.names = FALSE)
table3[8,8] <- paste0(table3[8,8], footnote_marker_symbol(1))
kable(table3, format = "latex", booktabs=TRUE, caption = "Table 3. Overview of analyzed species, listed in order of their relative contributions to woody stem productivity ($ANPP_{stem}$) in the plot, along with numbers and sizes sampled, and species traits. Variable abbreviations are as in Table 2.", escape=FALSE) %>%
  kable_styling(latex_options = c("scale_down", "hold_position"), font_size = 8.5, protect_latex = TRUE) %>%
  add_header_above(c(" "," "," ", "DBH (cm)" = 2, "species traits (mean +/- sd)" = 5)) %>%
  #kable_styling(bootstrap_options = "striped", full_width = FALSE)
kableExtra::footnote(symbol = c("Semi-ring porosity is intermediate between ring and diffuse. We group it with diffuse-porous species for more even division of species between categories."), footnote_as_chunk = FALSE)
```



\clearpage
```{r table 4, eval = TRUE, echo=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)
singlevar_table <- read.csv("tables_figures/publication/table4_singlevariable_models.csv", stringsAsFactors = FALSE, check.names = FALSE) #note: this table is a rearranged version of `tested_traits_all.csv`.
kable(singlevar_table, booktabs = TRUE, caption = "Table 4. Single-variable tests of hypothesized drivers of drought resistance. Models including each variable were compared to corresponding null models. dAIC is the AICc of the null model minus that of the model including the variable (thus, dAICc>2 indicates that the variable significantly improves the model). Variable abbreviations are as in Table 2.", format = 'latex', escape = FALSE) %>%
  kable_styling(latex_options = c("scale_down", "hold_position"), font_size = 12, protect_latex = TRUE) %>%
  add_header_above(c(" "," "," ","all droughts"=2,"1966"=2, "1977" = 2, "1999" = 2)) %>%
  pack_rows("Tree size and microenvironment", 1, 12, latex_gap_space = "1em", colnum = 3, hline_before = FALSE) %>%
  pack_rows("Species traits", 13, 18, latex_gap_space = "1em", colnum = 3, hline_before = FALSE) %>%
  #mutate(dAICc = cell_spec(dAICc, "html", bold = ifelse(dAICc > 1.999, TRUE, FALSE))) %>%  #trying to put sig values in bold, but this doen't work
  kable_styling()
```
*dAICc > 1: variable qualified for inclusion in full model

**dAICc > 2: statistically signficant, variable qualified for inclusion in full model

\clearpage
```{r table 5, eval = TRUE, echo=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)
multivar_table <- read.csv("tables_figures/publication/table5_multivariable_models.csv", stringsAsFactors = FALSE, check.names = FALSE) #note: this table is a rearranged version of `tested_traits_best_coeff.csv`.
kable(multivar_table, booktabs = TRUE, caption = "Table 5. Summary of top full models for each drought instance. Models are ranked by AICc, and we show all models whose AICc value falls within 1.0 (dAICc<1) of the best model (bold).", format = 'latex', escape = FALSE) %>%
  kable_styling(latex_options = c("scale_down", "hold_position"), font_size = 12, protect_latex = TRUE) %>%
  add_header_above(c(" "," "," "," "," ", "crown position" = 4, " ","xylem porosity" = 2," ", " ")) %>%
  pack_rows("", 1, 4, latex_gap_space = ".4em", colnum = 1, hline_before = FALSE) %>%
  pack_rows("", 5, 5, latex_gap_space = ".4em", colnum = 1, hline_before = FALSE) %>%
  pack_rows("", 6, 9, latex_gap_space = ".4em", colnum = 1, hline_before = FALSE) %>%
  pack_rows("", 10, 11, latex_gap_space = ".4em", colnum = 1, hline_before = FALSE) %>%
  row_spec(1, bold = T) %>%
  row_spec(5, bold = T) %>%
  row_spec(6, bold = T) %>%
  row_spec(10, bold = T) %>%
  kable_styling()
```

\newpage
### Figure Legends

**Figure 1. Climate and species-level growth responses over our study period, highlighting the three focal drougths (a) and community-wide responses** Time series plot (**a**) shows peak growing season (May-August) climate conditions and residual chronologies for each species. PET and PRE data were obtained from the Climatic Research Unit high-resolution gridded dataset (CRU TS v.4.01; Harris et al. 2014). Focal droughts are indicated by dashed lines, and shading indicates the pre-drought period used in calculations of the resistance metric. Figure modified from Helcoski *et al.* (2019). Density plots (**b**) show the distribution of resistance values for each drought.


**Figure 2. Height profiles in growing season climatic conditions, tree heights by crown position, and leaf hydraulic traits** Shown are averages ($\pm$ SD) of daily maxima and minima of (**a**) wind speed, (**b**) relative humidity ($RH$), and (**c**) air temperature ($T_{air}$) averaged over each month of the peak growing season (May-August) from 2016-2018. In these plots, heights are slightly offset for visualization purposes. Also shown is (**d**) 2018 tree heights by canopy position (see Table 2 for codes). In all plots, the dashed horizontal line indicates the 95th percentile of tree heigts in the ForestGEO plot.

\newpage

![**Figure 1. Climate and species-level growth responses over our study period, highlighting the three focal drougths (a) and community-wide responses** Time series plot (a) shows peak growing season (May-August) climate conditions and residual chronologies for each species. PET and PRE data were obtained from the Climatic Research Unit high-resolution gridded dataset (CRU TS v.4.01; Harris et al. 2014). Focal droughts are indicated by dashed lines, and shading indicates the pre-drought period used in calculations of the resistance metric. Figure modified from Helcoski *et al.* (2019). Density plots (b) show the distribution of resistance values for each drought.](tables_figures/publication/Figure1.png){width=500px}


![**Figure 2. Height profiles in growing season climatic conditions, tree heights by crown position, and leaf hydraulic traits** The top row shows averages ($\pm$ SD) of daily maxima and minima of (a) wind speed, (b) relative humidity ($RH$), and (c) air temperature ($T_{air}$) averaged over each month of the peak growing season (May-August) from 2016-2018. In these plots, heights are slightly offset for visualization purposes. Also shown is (d) 2018 tree heights by canopy position (see Table 2 for codes). In all plots, the dashed horizontal line indicates the 95th percentile of tree heigts in the ForestGEO plot.](tables_figures/publication/Figure2.png){width=500px}